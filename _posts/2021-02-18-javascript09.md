---
title : "20210218_JavaScript09 async, await API, ê°•ì˜ì™„ê°• " #ì œëª©
category : #ì¹´í…Œê³ ë¦¬
    - JavaScript
tag : #íƒœê·¸
    - JavaScript
    - async
    - await
   
   
toc : true #ì˜†ì— ëª©ì°¨
---


># JavaScript08

- JavaScriptì— ëŒ€í•´ ê³µë¶€í•˜ê¸° ìœ„í•´ì„œ ìœ íŠœë¸Œ 'ë“œë¦¼ì½”ë”©byì—˜ë¦¬' JavaScript ê°•ì˜ë¥¼ ë“£ê³  ê¸€ì„ ì“°ê³  ìˆë‹¤.(ê°•ì˜ê°€ ì—„ì²­ ì˜ë˜ ìˆìœ¼ë‹ˆ ê°•ì˜ë¥¼ ì°¾ì•„ë³´ì!)
  - [ë“œë¦¼ì½”ë”©byì—˜ë¦¬ - JavaScript](https://www.youtube.com/watch?v=wcsVjmHrUQg&list=PLv2d7VI9OotTVOL4QmPfvJWPJvkmv6h-2)   

<br>
<br>
<br>

># JavaScript async, await API

>## ë™ê¸° vs ë¹„ë™ê¸°

- ë™ê¸° ì‚¬ìš©ì‹œ ë°±ì—”ë“œì—ì„œ ê°€ì ¸ì˜¬ë•Œ ì‹œê°„ì´ ê±¸ë¦¬ê³  ê¸°ë‹¤ë ¤ì•¼í•´ì„œ ë‹¤ìŒ ì½”ë“œë¥¼ ì§„í–‰ ëª»í•´ ì‚¬ìš©ìëŠ” ë²„ë²…ê±°ë¦¼(ì¤‘ê°„ ë¡œë”©)ì„ ë³¼ ìˆ˜ ë°–ì— ì—†ìŒ

- ë¹„ë™ê¸°ë¥¼ ì‚¬ìš©í•´ì„œ ìš”ì²­ë§Œ í•´ë†“ê³  ê¸°ë‹¤ë¦¬ì§€ ì•Šê³  ë‹¤ë¥¸ ì½”ë“œë¥¼ ì§„í–‰ì‹œì¼œ ì™„ë£Œí›„ì— ìš”ì²­í•œ ê²°ê³¼ë¥¼ ì „ë‹¬í•¨


``` js
// ë™ê¸° ì‚¬ìš© 
// raccon í‘œì‹œê¹Œì§€ 10ì´ˆ
function fetchUser() { 
    // do network request in 10 sec...
    return 'raccoon'
} 



// ë¹„ë™ê¸° ì‚¬ìš©(promise ì‚¬ìš©)
// ì¼ë‹¨ raccoonì´ í‘œì‹œê°€ ë¨
function fetchUser() { 
    return new Promise((resolve, reject) => { 
        // do network request in 10 secs...
        resolve('raccoon'); 
    });
}
// promiseì‚¬ìš©ì‹œ ê¼­ resolve ë‚˜ rejectë¡œ ë§ˆë¬´ë¦¬ë¥¼ í•´ì¤˜ì•¼í•¨ ì•ˆê·¸ëŸ¬ë©´ ê³„ì† pendingì´ê³  resultë„ ì—†ìŒ
const user = fetchUser(); 
user.then(console.log);
console.log(user);
```

- promise chaningì„ ê³„ì†í•˜ë©´ ë‚œì¡í•´ì§ˆìˆ˜ ìˆìŒ
- async ì™€ await APIì„ ì“°ë©´ ë™ê¸°ì‹ ì½”ë“œ ì‘ì„± ì²˜ëŸ¼ ê°„í¸í•˜ê²Œ ë„ì™€ì¤Œ
  - syntactic sugar :ê¸°ì¡´ì˜ promiseìœ„ì— ê°„í¸í•œ APIë¥¼ ì œê³µí•˜ëŠ” asyncë¬¸ ì²˜ëŸ¼ ê¸°ì¡´ ê¸°ëŠ¥ì— ê°„í¸í•œ APIë¥¼ ì œê³µí•˜ëŠ” ê²ƒ (e.g class)

<br>
<br>
<br>

>## async API

  - clear style of using promise
  - promiseê°€ ë¬´ì¡°ê±´ ë‚˜ìœê±´ ì•„ë‹ˆê³  ìƒí™©ì— ë”°ë¼ ê¹”ë”í•´ ì§€ê±°ë‚˜ ì´í•´í•˜ê¸° ì‰¬ìš´(ê°€ë…ì„± ì¢‹ì€) ì½”ë“œë¡œ ì“°ë©´ ë¨
  - `async`ëŠ” ê¸°ì¡´ì˜ í•¨ìˆ˜ ì„ ì–¸ì— ë¶™ì—¬ ì‚¬ìš©í•˜ëŠ”ë°, **ë¶™ì´ë©´ ê·¸ í•¨ìˆ˜ì•ˆì˜ ì½”ë“œë“¤ì„ promiseë¡œ ë§Œë“¤ì–´ì£¼ê¸° ë•Œë¬¸ì— ë¹„ë™ê¸°ë¡œ ë§Œë“¤ì–´ ì¤Œ**

- **Promise -> async**

  - ëª¨ì–‘ë§Œ asyncê³  promise ìƒì„±ì´ ìƒëµëœê²ƒ ë¿ì„

``` js
function fetchUser() { 
    return new Promise((resolve, reject) => { 
        // do network request in 10 secs...
        resolve('raccoon'); 
    });
}

async function fetchUser() {
    // do network request in 10 sec...
    return 'raccoon';
}
```

<br>
<br>
<br>


>## await API

- aysnc APIë¥¼ í†µí•´ ì‚¬ìš©í• ë•Œ, ê¸°ë³¸ì ìœ¼ë¡œ ëª¨ë‘ promise ì•ˆì—ì„œ ì‹¤í–‰ ë˜ê¸° ë•Œë¬¸ì— ë¹„ë™ê¸° í˜•íƒœë¥¼ ê°€ì§€ëŠ”ë° ë¶€ë¶„ì ìœ¼ë¡œ ë™ê¸°ê°€ í•„ìš”í•œ ìƒí™©ë„ ìˆìŒ.
- ìœ„ì˜ ì´ìœ  ë•Œë¬¸ì— awaitë¥¼ í†µí•´ ë¶€ë¶„ì ìœ¼ë¡œ ë™ê¸°ë¡œ ë§Œë“¤ ìˆ˜ ìˆìŒ.
- awaitê°€ ìˆëŠ” ì½”ë“œëŠ” í•´ë‹¹ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ì—¬ ê²°ê³¼ê°€ ë‚˜ì˜¬ë•Œ ê¹Œì§€ ê¸°ë‹¤ë¦¼

``` js
"producer part"
function delay(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
}

async function getApple() {
    await delay(2000); // awaitì€ í•´ë‹¹ ì½”ë“œê°€ ëë‚ ë•Œ ê¹Œì§€ ê¸°ë‹¤ë ¤ì¤Œ ì¦‰, ë¹„ë™ê¸°ì˜ ì½”ë“œë¥¼ ë™ê¸°ë¡œ í•´ì¤Œ
    // throw 'error';
    return 'ğŸ';
}

"ë¹„ë™ê¸°ë¥¼ ë™ê¸°ë¡œ í™œìš©í•  ë•Œì˜ ì½”ë“œ í˜•íƒœ"
function getBanana() { 
    return delay(3000)
    .then(() => 'ğŸŒ');
}
         "VS"
async function getBanana() {
    await delay(1000); 
    return 'ğŸŒ';
}
    // ìœ„ì˜ chaining ë³´ë‹¤ ì•„ë˜ asyncì—ì„œ awaitë¥¼ í†µí•´ ë™ê¸°ë¡œ í™œìš©í•˜ì—¬ ì‚¬ìš©í•˜ë©´ ë” ì‰½ê²Œ ì´í•´ ê°€ëŠ¥
```

<br>

``` js
"consumer part"
"ë¹„ë™ê¸°ë¥¼ ë™ê¸°ë¡œ í™œìš©í•  ë•Œì˜ ì½”ë“œ í˜•íƒœ"
function pickFruits() {
    return getApple().then(apple => {
        return getBanana().then(banana => `${apple} + ${banana}`)
    });
}
               "VS"
async function pickFruits() {
    const apple = await getApple();
    const banana = await getBanana();
    return `${apple} + ${banana}`;
}
// async ì•ˆì—ì„œì˜ await ë™ê¸° í‘œí˜„ì´ ë” ê¹”ë”í•¨
```

<br>

- **ì—ëŸ¬ ì²˜ë¦¬**
  - `try` , `catch`

``` js
async function pickFruits() {
    try {
    const apple = await getApple();
    const banana = await getBanana();
    } catch { 
        return 'error'
    } 
    return `${apple} + ${banana}`;
}
```

<br>
<br>
<br>


>## ë³‘ë ¬ ì²˜ë¦¬

  - ì–´ì°¨í”¼ ë°”ë‚˜ë‚˜, ì‚¬ê³¼ ì„œë¡œ ì—°ê´€ì´ ì•ˆë˜ìˆê¸° ë•Œë¬¸ì—
  - ê¸°ì¡´ ì²˜ëŸ¼ getApple, getBananaë¥¼ ë™ê¸°ë¡œ ì—°ê²°í•˜ë©´ ì‹œê°„ì´ ë§ì´ ë“¤ìŒ
  - **ë°ì´í„° ë°›ì•„ì˜¤ëŠ” ê²ƒì€ ë¹„ë™ê¸°ë¥¼ í†µí•´ ë³‘ë ¬**ë¡œ ì²˜ë¦¬í•˜ê³  í• ë‹¹í• ë•Œì—ë§Œ ë™ê¸°ë¡œ ë§Œë“¤ìŒ
  - **ì‹œê°„ ì ˆì•½ ì¢‹ìŒ**

``` js
async function pickFruits() {
    const apple = await getApple();
    const banana = await getBanana();
    return `${apple} + ${banana}`;
}

async function pickFruits() {
    const applePromise = getApple(); // ë³‘ë ¬ë¡œ ë°ì´í„° ë°›ê³ 
    const bananaPromise = getBanana();
    const apple = await applePromise; // í™œìš©í•  ë³€ìˆ˜ í• ë‹¹ì‹œì—ëŠ” ë™ê¸°í™” ì‹œí‚´
    const banana = await bananaPromise;
    return `${apple} + ${banana}`;
}

pickFruits().then(console.log);
```

<br>
<br>
<br>

>## ìœ ìš©í•œ Promise APIs

- `Promise.All()` : promise ë°°ì—´ ì „ë‹¬ì‹œ ëª¨ë“  promiseë“¤ì´ ë³‘ë ¬ì ìœ¼ë¡œ ë‹¤ ë°›ì„ë•Œ ê¹Œì§€ ëª¨ì•„ì¤Œ (return promise ë°°ì—´ í˜•íƒœ)
- `Promise.race()` :  promise ë°°ì—´ ì „ë‹¬ì‹œ ê°€ì¥ ë¨¼ì € ê°’ì„ return í•˜ëŠ” promiseë§Œ return

``` js
function pickAllFruits() {
    return Promise.all([getApple(), getBanana()]) 
    .then(fruits => fruits.join(' + '));
}
pickAllFruits().then(console.log);


function pickOnlyOne() {
    return Promise.race([getApple(), getBanana()]); 
}
pickOnlyOne().then(console.log)
```

<br>
<br>
<br>
<br>

># ë…¸ë§ˆë“œ ì½”ë” : ë°”ë‹ë¼ ìë°”ìŠ¤í¬ë¦½íŠ¸

<br>

>## js

- JS : ì›¹ í˜ì´ì§€ ë‚´ì˜ ì´ë²¤íŠ¸ë¥¼ ìœ„í•´ì„œ ë§Œë“¤ìŒ -> ì ì  ë°œì „í•˜ë©´ì„œ í• ìˆ˜ ìˆëŠ” ê²ƒì´ ë§ì•„ì§ -> ì˜í–¥ë ¥ì´ ê°•í•´ì§
- ë§Œë“¤ìˆ˜ ìˆëŠ” ê²ƒë“¤ : ê³ í€„- ì›¹ì‚¬ì´íŠ¸, ì›¹ì•±, ëª¨ë°”ì¼ ì–´í”Œë¦¬ì¼€ì´ì…˜, ë¹„ë””ì˜¤ ê²Œì„, ë°ìŠ¤í¬í†± ì•±
- vscodeë„ jsë¡œ ë§Œë“¤ì–´ì§
- ëª¨ë“  ê¸°ê¸°ì—ëŠ” ë¸Œë¼ìš°ì €ê°€ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— ê²°êµ­ jsê°€ ëª¨ë‘ ê¹”ë ¤ìˆê³  í™œìš©ê°€ëŠ¥í•´ì„œ ì—„ì²­ë‚œ ì˜í–¥ë ¥ì´ë‹¤!
- ë¦¬ì–¼íƒ€ì„ì—ë„ ê°•í•¨


<br>
<br>
<br>

># ê¸€ì„ ë§ˆì¹˜ë©°..
- ì¼ë‹¨ ì•Œê³  ìˆëŠ” ë¶€ë¶„ì´ ë§ì•„ì„œ, ë¬¸ë²•ì€ ë¹ ë¥´ê²Œ ë“¤ìœ¼ë©´ì„œ ë³´ê³  ì§ì ‘ì ìœ¼ë¡œ jsë¥¼ í†µí•´ ë§Œë“œëŠ” ê²ƒë“¤ì„ ë³´ê³ ì í•œë‹¤.
- ìœ íŠœë¸Œ ë“œë¦¼ì½”ë”©ì˜ ì—˜ë¦¬ë‹˜ ê°•ì˜ëŠ” ì •ë§ë¡œ ì¢‹ì€ ê°•ì˜ ì˜€ë‹¤~ ê³µì§œì¸ê²Œ ì‹ ê¸°í• ì •ë„ë¡œ ì˜ ì•Œë ¤ì£¼ì…¨ë‹¤.
ê·¸ë™ì•ˆ python ì–¸ì–´ djangoë„ ê³µë¶€ í–ˆëŠ”ë° djangoì—ì„œ ì‚¬ìš©ë˜ëŠ” htmlì„ ë³´ë©´ì„œ ë‚˜ì¤‘ì— í˜ì´ì§€ ë‚´ì—ì„œì˜ ë™ì ì¸ ìš”ì†Œë¥¼ ì¶”ê°€í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ê³ ì jsë¥¼ ë°°ìš°ê¸°ë¡œ í–ˆê³  jsì— ëŒ€í•œ ë¬¸ë²•ë„ ì˜ ìµíŒ ê²ƒ ê°™ë‹¤. í•˜ì§€ë§Œ jsë¥¼ ì–´ë””ì—ì„œ ì–´ë–»ê²Œ ì‚¬ìš©ë˜ì–´ì§€ëŠ”ì§€ í™•ì‹¤í•˜ê²Œ ê°ì´ ì•ˆì™€ì„œ ë…¸ë§ˆë“œ ì½”ë”ë‹˜ì˜ ê°•ì˜ë¥¼ ë³´ê³ ì í–ˆë‹¤. 
- ë…¸ë§ˆë“œ ì½”ë”ë‹˜ì˜ ê°•ì˜ëŠ” í´ë¡  ìœ„ì£¼ë¼ì„œ í”„ë¡œì íŠ¸ê°€ ì–´ëŠì •ë„ ë“¤ì–´ê°€ ìˆì–´ì„œ ì–¸ì–´ ë³µìŠµë„ í• ê²¸ í”„ë¡œì íŠ¸ì—ì„œ ì–´ë–»ê²Œ ì“°ëŠ”ì§€ë„ ë³¼ê²¸ ë“¤ì–´ë³´ê¸°ë¡œ í•˜ì˜€ë‹¤. 
- ë°°ì›€ì—ëŠ” ëì´ ì—†ë‹¤. í™•ì‹¤íˆ, pythonë„ ì •ë§ ì¢‹ì€ ì–¸ì–´ì§€ë§Œ javascriptë„ ì—„ì²­ë‚œ ì–¸ì–´ ì„ì„ ë‹¤ì‹œê¸ˆ ëŠë¼ë©° ì›¹ì— ëŒ€í•œ ì „ì²´ì ì¸ êµ¬ì¡°ë¥¼ ì•Œì•„ë³´ë©´ ì¢‹ì„ ë“¯ í•˜ë‹¤. ê·¸ë¦¬ê³  ì´ë¥¼ í†µí•´ì„œ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•´ ë³¼ ì˜ˆì •ì´ë‹¤.
